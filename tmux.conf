set -g mouse on
set-option -ga terminal-overrides ',xterm-256color:Tc'

# for lazydocker
set-option -g default-command "newgrp docker; bash"
set-hook -g after-new-session 'run-shell "newgrp docker"'
set-option -g default-command "export DOCKER_HOST=unix:///var/run/docker.sock; bash"

# resolve ESC timelag
set -g escape-time 0

# pane operation
bind-key -T prefix x kill-pane

unbind %
bind | split-window -h -c "#{pane_current_path}"
unbind '"'
bind - split-window -v -c "#{pane_current_path}"
unbind c
bind c new-window -c "#{pane_current_path}"

vim_pattern='(\S+/)?g?\.?(view|l?n?vim?x?|fzf)(diff)?(-wrapped)?'
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +${vim_pattern}$'"

bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"

bind -n M-h if-shell "$is_vim" "send-keys M-h" "resize-pane -L 1"
bind -n M-j if-shell "$is_vim" "send-keys M-j" "resize-pane -D 1"
bind -n M-k if-shell "$is_vim" "send-keys M-k" "resize-pane -U 1"
bind -n M-l if-shell "$is_vim" "send-keys M-l" "resize-pane -R 1"

unbind C-M-h
unbind C-M-j
unbind C-M-k
unbind C-M-l
bind -n C-Down swap-pane -D
bind -n C-Up   swap-pane -U

# window operation
bind ] next-window
bind [ previous-window
